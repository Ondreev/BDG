<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–ò–í–ò BDG ‚Äî –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–∫—É–ø–æ–∫</title>
    <link rel="icon" type="image/png" href="https://cdn.abacus.ai/images/9def1789-3a84-47d1-8403-586336c53bdd.png">
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <style>
        body{background:#ff3ebf;margin:0;padding:0;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;min-height:100vh}
        .container{max-width:500px;margin:32px auto;background:#fff;border-radius:18px;box-shadow:0 2px 16px rgba(0,0,0,.1);overflow:hidden;padding-bottom:24px}
        /* --- header --- */
        .header{background:#ff3ebf;color:#fff;padding:28px 24px 18px 24px;display:flex;justify-content:space-between}
        .logo-block{display:flex;flex-direction:column}
        .bdg-logo{font-size:2.2rem;font-weight:900;letter-spacing:.12em;display:flex;align-items:center;gap:10px}
        .bdg-logo img{width:32px;height:32px}
        .subtitle{font-size:.92rem;opacity:.85;margin-left:2px}
        .header-buttons{display:flex;flex-direction:column;gap:8px}
        .download-btn,.telegram-btn{background:#fff;border:none;border-radius:8px;padding:6px 12px;font-size:.9rem;font-weight:600;display:flex;align-items:center;gap:6px;cursor:pointer;box-shadow:0 2px 8px rgba(0,0,0,.07);transition:.2s}
        .download-btn{color:#ff3ebf}
        .download-btn:hover{background:#ffe0f4;color:#d6007a}
        .telegram-btn{color:#179cde;text-decoration:none;justify-content:center}
        .telegram-btn:hover{background:#e5f5fb;color:#0f6fa0}
        /* --- controls --- */
        .controls{display:flex;gap:8px;justify-content:center;margin:16px 24px 0 24px;flex-wrap:wrap}
        .controls button{background:#fff6fb;color:#ff3ebf;border:none;border-radius:8px;padding:6px 12px;font-size:.85rem;font-weight:600;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,.06);transition:.2s}
        .controls button:hover{background:#ffe0f4;color:#d6007a}
        /* budget & summary */
        .budget-block{display:flex;justify-content:space-between;align-items:center;margin:18px 24px 0 24px;gap:16px}
        .budget-input input{width:120px;padding:10px;border:2px solid #ffb6e6;border-radius:8px;font-size:1.1rem;font-weight:bold;color:#ff3ebf;background:#fff6fb}
        .budget-input input:focus{outline:none;border-color:#ff3ebf}
        .summary{text-align:right;font-size:1rem;color:#ff3ebf}
        .summary .list-caption{font-size:.85rem;color:#d6007a;margin-bottom:4px}
        .spent{font-weight:bold}
        .remaining{font-weight:bold;color:#34C759}
        .warning{background:#ffe0f4;color:#d6007a;padding:10px;border-radius:6px;margin:18px 24px 0 24px;text-align:center;font-weight:bold;display:none}
        /* stores & items */
        .stores-list{margin:24px 24px 0 24px}
        .store{border:1px solid #ffe0f4;border-radius:8px;margin-bottom:20px}
        .store-header{background:#fff6fb;padding:10px 15px;display:flex;align-items:center;gap:8px}
        .store-name{flex:1;font-weight:bold;color:#ff3ebf;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
        .store-subtotal{color:#d6007a;font-weight:bold}
        .store-delete{background:none;border:none;color:#d6007a;font-size:1.3rem;cursor:pointer}
        .items-list{padding:0}
        .item{display:flex;align-items:center;padding:12px 15px;border-bottom:1px solid #fff6fb}
        .item:last-child{border-bottom:none}
        .item input[type=checkbox]{margin-right:12px;transform:scale(1.2)}
        .item-details{flex:1}
        .item-name{font-weight:500;color:#333;cursor:grab}
        .item-calc{font-size:.95rem;color:#666}
        .item-total{font-weight:bold;color:#ff3ebf;margin-left:8px}
        .item-edit{background:none;border:none;color:#d6007a;font-size:1.2rem;cursor:pointer;margin-left:auto}
        .item-delete{background:none;border:none;color:#d6007a;font-size:1.2rem;cursor:pointer;margin-left:auto}
        .item.checked{opacity:.6}
        .item.checked .item-details{text-decoration:line-through}
        .add-buttons{margin:24px 24px 0 24px;display:flex;gap:10px;flex-wrap:wrap}
        .btn-primary{background:#ff3ebf;color:#fff;border:none;border-radius:6px;padding:10px 15px;font-size:1rem;cursor:pointer}
        .btn-secondary{background:#fff6fb;color:#ff3ebf;border:none;border-radius:6px;padding:10px 15px;font-size:1rem;cursor:pointer}
        .btn-primary:hover{background:#d6007a}
        .btn-secondary:hover{background:#ffe0f4}
        /* bottom about */
        .about{margin:24px;text-align:center}
        .about button{background:#fff6fb;color:#ff3ebf;border:none;border-radius:8px;padding:10px 16px;font-size:1rem;font-weight:600;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,.06)}
        .about button:hover{background:#ffe0f4;color:#d6007a}
        /* modals generic */
        .modal-overlay{position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,.3);display:none;align-items:center;justify-content:center;z-index:2000}
        .modal{background:#fff;border-radius:14px;padding:24px;max-width:400px;width:92vw;max-height:82vh;overflow-y:auto}
        .modal h2{color:#ff3ebf;margin-top:0;font-size:1.2rem}
        .modal-buttons{display:flex;gap:10px;justify-content:flex-end;margin-top:14px}
        .autocomplete-list{position:absolute;top:100%;left:0;width:100%;background:#fff;border:1px solid #ddd;border-radius:6px;box-shadow:0 2px 8px rgba(0,0,0,.1);z-index:10;list-style:none;margin:0;padding:0}
        .autocomplete-list li{padding:10px;cursor:pointer}
        .autocomplete-list li:hover{background:#ffe0f4}
        @media(max-width:600px){.container{max-width:calc(100vw - 16px);margin:8px}}
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <div class="logo-block">
            <div class="bdg-logo"><img src="https://cdn.abacus.ai/images/9def1789-3a84-47d1-8403-586336c53bdd.png" alt="üõí">BDG</div>
            <div class="subtitle">–ü—Ä–æ–¥—É–∫—Ç –ö–ò–í–ò –ú–∞—Ä–∫–µ—Ç</div>
        </div>
        <div class="header-buttons">
            <button class="download-btn" onclick="showDownloadInfo()">üì• –°–ö–ê–ß–ê–¢–¨</button>
            <a class="telegram-btn" href="https://t.me/ondreeff" target="_blank">–ö–ò–í–ò –ú–∞—Ä–∫–µ—Ç</a>
        </div>
    </div>
    <!-- controls row -->
    <div class="controls">
        <button onclick="showListsModal()">üìã –°–ø–∏—Å–∫–∏</button>
        <button onclick="saveCurrentList()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <button onclick="createNewList()">‚ûï –°–æ–∑–¥–∞—Ç—å</button>
    </div>
    <!-- budget block -->
    <div class="budget-block">
        <div class="budget-input"><input id="budgetInput" type="number" placeholder="–ë—é–¥–∂–µ—Ç" min="0"></div>
        <div class="summary">
            <div class="list-caption">–°–ø–∏—Å–æ–∫: <span id="currentListName"></span></div>
            <div>–ü–æ—Ç—Ä–∞—á–µ–Ω–æ: <span class="spent" id="spentAmount">0</span> —Ä—É–±</div>
            <div>–û—Å—Ç–∞—Ç–æ–∫: <span class="remaining" id="remainingAmount">0</span> —Ä—É–±</div>
        </div>
    </div>
    <div id="warningMessage" class="warning">‚ö†Ô∏è –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –±—é–¥–∂–µ—Ç–∞ –Ω–∞ <span id="overBudgetAmount">0</span> —Ä—É–±.</div>
    <div id="storesList" class="stores-list"></div>
    <div class="add-buttons">
        <button class="btn-primary" onclick="openAddStoreModal()">+ –î–æ–±–∞–≤–∏—Ç—å –º–∞–≥–∞–∑–∏–Ω</button>
        <button class="btn-secondary" onclick="showAboutModal()">–û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</button>
    </div>
</div>
<!-- ----- MODALS ----- -->
<div id="downloadPopup" class="modal-overlay"><div class="modal"><h2>–ö–∞–∫ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω?</h2><p><b>Android:</b> Chrome ‚Üí ¬´–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω¬ª.</p><p><b>iPhone:</b> Safari ‚Üí –ü–æ–¥–µ–ª–∏—Ç—å—Å—è ‚Üí ¬´–ù–∞ —ç–∫—Ä–∞–Ω \"–î–æ–º–æ–π\"¬ª.</p><div class="modal-buttons"><button class="btn-secondary" onclick="closeDownloadInfo()">–ó–∞–∫—Ä—ã—Ç—å</button></div></div></div>
<!-- lists modal -->
<div id="listsModal" class="modal-overlay"><div class="modal"><h2>–ú–æ–∏ —Å–ø–∏—Å–∫–∏</h2><ul id="listsList" style="list-style:none;padding:0"></ul><div class="modal-buttons"><button class="btn-primary" onclick="createNewList();closeListsModal()">+ –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π</button><button class="btn-secondary" onclick="closeListsModal()">–ó–∞–∫—Ä—ã—Ç—å</button></div></div></div>
<!-- add store modal -->
<div id="storeModal" class="modal-overlay"><div class="modal"><h2>–î–æ–±–∞–≤–∏—Ç—å –º–∞–≥–∞–∑–∏–Ω</h2><input id="storeName" type="text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞" style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:1rem;margin-bottom:14px"><div class="modal-buttons"><button class="btn-secondary" onclick="closeStoreModal()">–û—Ç–º–µ–Ω–∞</button><button class="btn-primary" onclick="addStore()">–î–æ–±–∞–≤–∏—Ç—å</button></div></div></div>
<!-- item modal -->
<div id="itemModal" class="modal-overlay"><div class="modal"><h2 id="itemModalTitle">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</h2><div style="position:relative;margin-bottom:12px"><input id="itemName" type="text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞" style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:1rem" oninput="showAutocomplete()"><ul id="autocompleteList" class="autocomplete-list" style="display:none"></ul></div><input id="itemQuantity" type="number" min="0.01" step="0.01" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ" style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:1rem;margin-bottom:12px"><input id="itemPrice" type="number" min="0" step="0.01" placeholder="–¶–µ–Ω–∞" style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:1rem;margin-bottom:12px"><div class="modal-buttons"><button class="btn-secondary" onclick="closeItemModal()">–û—Ç–º–µ–Ω–∞</button><button class="btn-primary" id="itemModalSaveBtn" onclick="addOrEditItem()">–î–æ–±–∞–≤–∏—Ç—å</button></div></div></div>
<!-- about modal -->
<div id="aboutModal" class="modal-overlay"><div class="modal"><h2>–û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</h2><p>–ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ –ø–æ–∫—É–ø–∫–∏, –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–π—Ç–µ –±—é–¥–∂–µ—Ç, —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–∏—Å–∫–æ–≤ –∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–π—Ç–µ —Ç–æ–≤–∞—Ä—ã –º–µ–∂–¥—É –º–∞–≥–∞–∑–∏–Ω–∞–º–∏. –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏ –Ω–∞–¥—ë–∂–Ω–æ –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ.</p><ul><li>–ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ø–∏—Å–∫–æ–≤</li><li>–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥—Ä–æ–±–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞</li><li>Drag & Drop —Ç–æ–≤–∞—Ä–æ–≤</li><li>–ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏–π</li><li>–†–∞–±–æ—Ç–∞–µ—Ç –æ—Ñ–ª–∞–π–Ω</li></ul><div class="modal-buttons"><button class="btn-secondary" onclick="closeAboutModal()">–ó–∞–∫—Ä—ã—Ç—å</button></div></div></div>
<script>
const STORAGE_KEY = 'shoppingAppAllLists_v2';
const BACKUP_KEY = 'shoppingAppBackup_v2';
let allLists = [];
let currentListIndex = 0;
let appData = {budget:0,stores:[],allItems:[]};
let currentStoreIndex=-1,editItemIndex=-1,longPressTimer=null;

/* === storage helpers === */
function saveAll(){const payload={version:2,lists:allLists};localStorage.setItem(STORAGE_KEY,JSON.stringify(payload));localStorage.setItem(BACKUP_KEY,JSON.stringify(payload));}
function loadAll(){let payload=null;try{payload=JSON.parse(localStorage.getItem(STORAGE_KEY));}catch(e){}
 if(!payload||!payload.lists){try{payload=JSON.parse(localStorage.getItem(BACKUP_KEY));}catch(e){}}
 if(!payload||!payload.lists){createDefault();return;}
 allLists=payload.lists;}
function createDefault(){allLists=[{name:'–ú–æ–π —Å–ø–∏—Å–æ–∫',date:new Date().toISOString().slice(0,10),data:{budget:0,stores:[],allItems:[]}}];saveAll();}

/* === list management === */
function loadCurrent(){appData=JSON.parse(JSON.stringify(allLists[currentListIndex].data));if(!appData.allItems)appData.allItems=[];updateCurrentListName();}
function updateCurrentListName(){document.getElementById('currentListName').textContent=allLists[currentListIndex].name;}
function showListsModal(){const ul=document.getElementById('listsList');ul.innerHTML='';allLists.forEach((l,idx)=>{const li=document.createElement('li');li.style.padding='8px 0';li.innerHTML=`<strong>${l.name}</strong> <small style="color:#888">${l.date}</small> ${idx===currentListIndex?'<span style="color:#ff3ebf;font-weight:bold">(—Ç–µ–∫—É—â–∏–π)</span>':`<span style="color:#ff3ebf;font-weight:bold;cursor:pointer" onclick="selectList(${idx})">–û—Ç–∫—Ä—ã—Ç—å</span>`} ${allLists.length>1?`<button onclick="deleteList(${idx})">√ó</button>`:''}`;ul.appendChild(li);});document.getElementById('listsModal').style.display='flex';}
function closeListsModal(){document.getElementById('listsModal').style.display='none';}
function selectList(i){currentListIndex=i;loadCurrent();renderApp();closeListsModal();}
function deleteList(i){if(allLists.length===1||!confirm('–£–¥–∞–ª–∏—Ç—å —Å–ø–∏—Å–æ–∫?'))return;allLists.splice(i,1);if(currentListIndex>=allLists.length)currentListIndex=allLists.length-1;saveAll();loadCurrent();renderApp();showListsModal();}
function createNewList(){const n=prompt('–ù–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–ø–∏—Å–∫–∞:','–°–ø–∏—Å–æ–∫ '+new Date().toLocaleDateString());if(n===null)return;allLists.push({name:(n.trim()||'–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è'),date:new Date().toISOString().slice(0,10),data:{budget:0,stores:[],allItems:[]}});currentListIndex=allLists.length-1;saveAll();loadCurrent();renderApp();}
function saveCurrentList(){const newName=prompt('–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫:',allLists[currentListIndex].name);if(newName!==null){allLists[currentListIndex].name=(newName.trim()||allLists[currentListIndex].name);allLists[currentListIndex].date=new Date().toISOString().slice(0,10);}allLists[currentListIndex].data=JSON.parse(JSON.stringify(appData));saveAll();updateCurrentListName();alert('–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ!');}

/* === rendering === */
window.addEventListener('load',()=>{loadAll();loadCurrent();renderApp();document.getElementById('budgetInput').addEventListener('input',e=>{appData.budget=parseFloat(e.target.value)||0;updateSummary();allLists[currentListIndex].data=appData;saveAll();});});
function renderApp(){document.getElementById('budgetInput').value=appData.budget||'';renderStores();updateSummary();initDnD();}
function renderStores(){const cont=document.getElementById('storesList');cont.innerHTML='';appData.stores.forEach((s,si)=>{const subtotal=s.items.reduce((t,it)=>t+it.quantity*it.price,0);const div=document.createElement('div');div.className='store';div.innerHTML=`<div class="store-header"><input type="checkbox" onchange="toggleAll(${si})"><div class="store-name">${s.name}</div><div class="store-subtotal">${Math.round(subtotal)} —Ä—É–±</div><button class="store-delete" onclick="deleteStore(${si})">√ó</button></div><ul class="items-list" id="items-${si}"></ul><div class="add-buttons"><button class="btn-secondary" onclick="openAddItemModal(${si})">+ –¢–æ–≤–∞—Ä</button></div>`;cont.appendChild(div);renderItems(si);});}
function renderItems(si){const ul=document.getElementById('items-'+si);ul.innerHTML='';appData.stores[si].items.forEach((it,ii)=>{const li=document.createElement('li');li.className='item'+(it.bought?' checked':'');li.dataset.storeIndex=si;li.dataset.itemIndex=ii;li.innerHTML=`<input type="checkbox" onclick="toggleItem(${si},${ii})" ${it.bought?'checked':''}><div class="item-details"><div class="item-name">${it.name}</div><div class="item-calc">${it.quantity} √ó ${it.price}</div></div><div class="item-total">${Math.round(it.quantity*it.price)} —Ä—É–±</div><button class="item-edit" onclick="openEditItemModal(${si},${ii})">‚úèÔ∏è</button><button class="item-delete" onclick="deleteItem(${si},${ii})">√ó</button>`;ul.appendChild(li);});}
function updateSummary(){const spent=appData.stores.reduce((tot,s)=>tot+s.items.reduce((t,it)=>t+it.quantity*it.price,0),0);document.getElementById('spentAmount').textContent=Math.round(spent);const rem=appData.budget-spent;document.getElementById('remainingAmount').textContent=Math.round(rem);const warn=document.getElementById('warningMessage');warn.style.display=rem<0?'block':'none';document.getElementById('overBudgetAmount').textContent=Math.abs(Math.round(rem));allLists[currentListIndex].data=appData;saveAll();}
/* stores */
function openAddStoreModal(){document.getElementById('storeName').value='';document.getElementById('storeModal').style.display='flex';}
function closeStoreModal(){document.getElementById('storeModal').style.display='none';}
function addStore(){const name=document.getElementById('storeName').value.trim();if(!name)return;appData.stores.push({name,items:[]});closeStoreModal();renderApp();}
function deleteStore(i){if(confirm('–£–¥–∞–ª–∏—Ç—å –º–∞–≥–∞–∑–∏–Ω?')){appData.stores.splice(i,1);renderApp();}}
/* items */
function openAddItemModal(si){currentStoreIndex=si;editItemIndex=-1;document.getElementById('itemModalTitle').textContent='–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä';document.getElementById('itemModalSaveBtn').textContent='–î–æ–±–∞–≤–∏—Ç—å';document.getElementById('itemName').value='';document.getElementById('itemQuantity').value='1';document.getElementById('itemPrice').value='';document.getElementById('itemModal').style.display='flex';}
function openEditItemModal(si,ii){currentStoreIndex=si;editItemIndex=ii;const it=appData.stores[si].items[ii];document.getElementById('itemModalTitle').textContent='–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä';document.getElementById('itemModalSaveBtn').textContent='–°–æ—Ö—Ä–∞–Ω–∏—Ç—å';document.getElementById('itemName').value=it.name;document.getElementById('itemQuantity').value=it.quantity;document.getElementById('itemPrice').value=it.price;document.getElementById('itemModal').style.display='flex';}
function closeItemModal(){document.getElementById('itemModal').style.display='none';}
function addOrEditItem(){const name=document.getElementById('itemName').value.trim();const qty=parseFloat(document.getElementById('itemQuantity').value);const price=parseFloat(document.getElementById('itemPrice').value);if(!name||isNaN(qty)||isNaN(price))return;if(editItemIndex===-1){appData.stores[currentStoreIndex].items.push({name,quantity:qty,price,bought:false});if(!appData.allItems.find(i=>i.name===name))appData.allItems.push({name,quantity:qty,price});}else{const it=appData.stores[currentStoreIndex].items[editItemIndex];it.name=name;it.quantity=qty;it.price=price;}closeItemModal();renderApp();updateSummary();}
function deleteItem(si,ii){if(confirm('–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä?')){appData.stores[si].items.splice(ii,1);renderApp();updateSummary();}}
function toggleItem(si,ii){const it=appData.stores[si].items[ii];it.bought=!it.bought;updateSummary();renderItems(si);}
function toggleAll(si){const chk=document.querySelector('#items-'+si).parentElement.querySelector('input[type=checkbox]');appData.stores[si].items.forEach(it=>it.bought=chk.checked);updateSummary();renderItems(si);}
/* autocomplete */
function showAutocomplete(){const inp=document.getElementById('itemName');const list=document.getElementById('autocompleteList');const v=inp.value.toLowerCase();list.innerHTML='';if(v.length<2){list.style.display='none';return;}const sugg=appData.allItems.map(i=>i.name).filter(n=>n.toLowerCase().startsWith(v)).slice(0,5);if(!sugg.length){list.style.display='none';return;}sugg.forEach(s=>{const li=document.createElement('li');li.textContent=s;li.onclick=()=>{inp.value=s;list.style.display='none';};list.appendChild(li);});list.style.display='block';}
/* drag */
function initDnD(){appData.stores.forEach((s,si)=>{const ul=document.getElementById('items-'+si);new Sortable(ul,{group:'shared',handle:'.item-name',animation:150,onMove:evt=>{return evt.dragged.dataset.storeIndex!==evt.to.dataset.storeIndex;},onUpdate:evt=>{const oldStoreIndex=parseInt(evt.from.dataset.storeIndex);const newStoreIndex=parseInt(evt.to.dataset.storeIndex);const oldIndex=evt.oldIndex;const newIndex=evt.newIndex;if(oldStoreIndex===newStoreIndex)return;const item=appData.stores[oldStoreIndex].items.splice(oldIndex,1)[0];appData.stores[newStoreIndex].items.splice(newIndex,0,item);renderApp();updateSummary();}});});}
/* about & download */
function showAboutModal(){document.getElementById('aboutModal').style.display='flex';}
function closeAboutModal(){document.getElementById('aboutModal').style.display='none';}
function showDownloadInfo(){document.getElementById('downloadPopup').style.display='flex';}
function closeDownloadInfo(){document.getElementById('downloadPopup').style.display='none';}
</script>
</body>
</html>
