<!DOCTYPE html>
<!-- –§–∞–π–ª –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Ö–æ–ª—Å—Ç–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–≥/—à—Ç -->
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–ö–ò–í–ò BDG ‚Äî –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–∫—É–ø–æ–∫</title>
  <link rel="icon" type="image/png" href="https://cdn.abacus.ai/images/9def1789-3a84-47d1-8403-586336c53bdd.png"/>
  <style>
    body {
      background: #ff3ebf;
      min-height: 100vh;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      margin: 0;
      padding: 0 12px;
    }
    .container {
      max-width: 600px;
      margin: 20px auto;
      background: white;
      border-radius: 10px;
      padding: 20px;
    }
    .store, .item {
      border: 1px solid #ffe0f4;
      border-radius: 8px;
      margin-bottom: 12px;
      padding: 10px;
      background: #fff6fb;
    }
    .item.checked { opacity: 0.6; }
    .btn {
      padding: 6px 12px;
      margin: 4px 0;
      border: none;
      border-radius: 6px;
      background: #ff3ebf;
      color: white;
      cursor: pointer;
    }
  </style>
</head>
<body>
<div class="container">
  <h2>üõí –ö–ò–í–ò BDG ‚Äî –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫</h2>
  <input type="number" id="budgetInput" placeholder="–ë—é–¥–∂–µ—Ç (—Ä—É–±)" />
  <div>–ü–æ—Ç—Ä–∞—á–µ–Ω–æ: <span id="spentAmount">0</span> ‚ÇΩ</div>
  <div>–û—Å—Ç–∞—Ç–æ–∫: <span id="remainingAmount">0</span> ‚ÇΩ</div>
  <div id="storesList"></div>
  <button class="btn" onclick="addDemoStore()">+ –î–æ–±–∞–≤–∏—Ç—å –º–∞–≥–∞–∑–∏–Ω</button>
</div>

<div id="itemModal" style="display:none;background:#fff;padding:20px;position:fixed;top:10%;left:50%;transform:translateX(-50%);z-index:1000;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,0.3);">
  <h3>–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</h3>
  <input type="text" id="itemName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ" /><br/>
  <input type="number" id="itemQuantity" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ" /><br/>
  <select id="itemUnit">
    <option value="—à—Ç">—à—Ç</option>
    <option value="–∫–≥">–∫–≥</option>
  </select><br/>
  <input type="number" id="itemPrice" placeholder="–¶–µ–Ω–∞" /><br/>
  <button onclick="addItem()">–î–æ–±–∞–≤–∏—Ç—å</button>
  <button onclick="closeItemModal()">–û—Ç–º–µ–Ω–∞</button>
</div>

<script>
  let appData = { budget: 0, stores: [], allItems: [] };
  let currentStoreIndex = -1;

  function saveData() {
    localStorage.setItem('shoppingAppData', JSON.stringify(appData));
  }

  function loadData() {
    const saved = localStorage.getItem('shoppingAppData');
    if (saved) {
      appData = JSON.parse(saved);
    } else {
      appData = {
        budget: 5000,
        stores: [
          {
            name: "–ü—è—Ç—ë—Ä–æ—á–∫–∞",
            items: [
              { name: "–•–ª–µ–±", quantity: 1, price: 50, unit: "—à—Ç", bought: false },
              { name: "–ú–æ–ª–æ–∫–æ", quantity: 1, price: 70, unit: "–ª", bought: false }
            ]
          }
        ],
        allItems: []
      };
    }
  }

  function renderApp() {
    document.getElementById("budgetInput").value = appData.budget;
    document.getElementById("budgetInput").oninput = function () {
      appData.budget = parseFloat(this.value) || 0;
      saveData();
      updateSummary();
    };
    renderStores();
    updateSummary();
  }

  function renderStores() {
    const container = document.getElementById("storesList");
    container.innerHTML = "";
    appData.stores.forEach((store, storeIndex) => {
      const div = document.createElement("div");
      div.className = "store";
      const subtotal = store.items.reduce((sum, i) => sum + (i.quantity * i.price), 0).toFixed(2);
      div.innerHTML = `<strong>${store.name}</strong> ‚Äî ${subtotal} ‚ÇΩ`;
      store.items.forEach((item, itemIndex) => {
        const itemDiv = document.createElement("div");
        itemDiv.className = "item" + (item.bought ? " checked" : "");
        itemDiv.innerHTML = `
          <label><input type="checkbox" ${item.bought ? "checked" : ""} onchange="toggleItem(${storeIndex}, ${itemIndex})"/> 
          ${item.name} ‚Äî ${item.quantity} ${item.unit || '—à—Ç'} √ó ${item.price}‚ÇΩ = ${(item.quantity * item.price).toFixed(2)}‚ÇΩ</label>
          <button onclick="deleteItem(${storeIndex}, ${itemIndex})">√ó</button>
        `;
        div.appendChild(itemDiv);
      });
      const btn = document.createElement("button");
      btn.className = "btn";
      btn.innerText = "+ –¢–æ–≤–∞—Ä";
      btn.onclick = () => openAddItemModal(storeIndex);
      div.appendChild(btn);
      container.appendChild(div);
    });
  }

  function toggleItem(storeIdx, itemIdx) {
    appData.stores[storeIdx].items[itemIdx].bought = !appData.stores[storeIdx].items[itemIdx].bought;
    saveData();
    renderApp();
  }

  function updateSummary() {
    const spent = appData.stores.reduce((total, store) =>
      total + store.items.reduce((sum, i) => i.bought ? sum + i.price * i.quantity : sum, 0), 0);
    document.getElementById("spentAmount").innerText = spent.toFixed(2);
    document.getElementById("remainingAmount").innerText = (appData.budget - spent).toFixed(2);
  }

  function addDemoStore() {
    appData.stores.push({ name: "–ù–æ–≤—ã–π –º–∞–≥–∞–∑–∏–Ω", items: [] });
    saveData();
    renderApp();
  }

  function openAddItemModal(storeIdx) {
    currentStoreIndex = storeIdx;
    document.getElementById("itemName").value = "";
    document.getElementById("itemQuantity").value = 1;
    document.getElementById("itemPrice").value = "";
    document.getElementById("itemUnit").value = "—à—Ç";
    document.getElementById("itemModal").style.display = "block";
  }

  function closeItemModal() {
    document.getElementById("itemModal").style.display = "none";
  }

  function addItem() {
    const name = document.getElementById("itemName").value;
    const quantity = parseFloat(document.getElementById("itemQuantity").value);
    const price = parseFloat(document.getElementById("itemPrice").value);
    const unit = document.getElementById("itemUnit").value || "—à—Ç";
    if (!name || price <= 0 || quantity <= 0) return alert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è");
    appData.stores[currentStoreIndex].items.push({ name, quantity, price, unit, bought: false });
    saveData();
    closeItemModal();
    renderApp();
  }

  function deleteItem(storeIdx, itemIdx) {
    appData.stores[storeIdx].items.splice(itemIdx, 1);
    saveData();
    renderApp();
  }

  loadData();
  renderApp();
</script>
</body>
</html>
